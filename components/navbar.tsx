"use client";

import { useState } from "react";
import { NavLinks } from "@/components/nav-links";
import { Menu, X } from "lucide-react";
import { CustomButton } from "@/components/ui/custom-button";
import { useRouter } from "next/navigation";
import { trackEvent } from 'fathom-client';

export function Navbar() {
  const [isMenuOpen, setIsMenuOpen] = useState(false);
  const router = useRouter();

  return (
    <nav className="fixed top-0 left-0 right-0 w-full bg-[#EEF2FF]/80 backdrop-blur-md z-50 py-2">
      <div className="flex w-full max-w-[1280px] mx-auto px-8 justify-center items-center h-16 gap-8">
        <div className="flex items-center gap-8 flex-grow">
          {/* Logo */}
          <div className="flex items-center gap-2">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="32"
              height="32"
              viewBox="0 0 32 32"
              fill="none"
            >
              <g
                clipPath="url(#bgblur_0_265_2159_clip_path)"
                data-figma-skip-parse="true"
              >
                <foreignObject x="0" y="0" width="0" height="0">
                  <div
                    style={{
                      backdropFilter: "blur(2px)",
                      height: "100%",
                      width: "100%",
                    }}
                  ></div>
                </foreignObject>
              </g>
              <path
                data-figma-bg-blur-radius="4"
                fillRule="evenodd"
                clipRule="evenodd"
                d="M32 16C32 7.16344 24.8366 0 16 0C7.16344 0 0 7.16344 0 16C0 24.8366 7.16344 32 16 32C24.8366 32 32 24.8366 32 16ZM14 16C14 23.0216 14.5654 28.9869 15.3518 31.141C15.2033 30.987 15.0428 30.7748 14.8735 30.4882C14.43 29.7379 14.0133 28.619 13.6566 27.1924C12.9453 24.3471 12.5 20.3897 12.5 16C12.5 11.6103 12.9453 7.65294 13.6566 4.80756C14.0133 3.38102 14.43 2.26206 14.8735 1.51177C15.0428 1.22523 15.2033 1.01296 15.3518 0.858971C14.5654 3.01313 14 8.97835 14 16ZM17.1265 30.4882C16.9572 30.7748 16.7967 30.987 16.6482 31.141C17.4346 28.9869 18 23.0216 18 16C18 8.97836 17.4346 3.01313 16.6482 0.858968C16.7967 1.01296 16.9572 1.22522 17.1265 1.51177C17.57 2.26206 17.9867 3.38102 18.3434 4.80756C19.0547 7.65294 19.5 11.6103 19.5 16C19.5 20.3897 19.0547 24.3471 18.3434 27.1924C17.9867 28.619 17.57 29.7379 17.1265 30.4882ZM14.5393 30.8997C14.3727 30.7619 14.2057 30.5993 14.0387 30.4109C13.3759 29.6634 12.7561 28.5531 12.2255 27.1381C11.1657 24.312 10.5 20.3742 10.5 16C10.5 11.6258 11.1657 7.68799 12.2255 4.86185C12.7561 3.44694 13.3759 2.33665 14.0387 1.58906C14.2057 1.40069 14.3727 1.23813 14.5393 1.10034C13.0526 3.43413 12 9.22536 12 16C12 22.7746 13.0526 28.5659 14.5393 30.8997ZM17.4607 30.8997C17.6273 30.7619 17.7943 30.5993 17.9613 30.4109C18.6241 29.6634 19.2439 28.5531 19.7745 27.1381C20.8343 24.312 21.5 20.3742 21.5 16C21.5 11.6258 20.8343 7.68799 19.7745 4.86185C19.2439 3.44694 18.6241 2.33665 17.9613 1.58906C17.7943 1.40069 17.6273 1.23813 17.4607 1.10034C18.9474 3.43413 20 9.22536 20 16C20 22.7746 18.9474 28.5659 17.4607 30.8997ZM10.7904 27.0901C11.6025 28.7143 12.5614 29.9223 13.592 30.6593C11.4772 28.1855 10 22.5528 10 16C10 9.44723 11.4772 3.8145 13.592 1.34066C12.5614 2.07772 11.6025 3.28569 10.7904 4.9099C9.38417 7.72227 8.5 11.6425 8.5 16C8.5 20.3575 9.38417 24.2777 10.7904 27.0901ZM21.2096 27.0901C20.3975 28.7143 19.4386 29.9223 18.408 30.6593C20.5228 28.1855 22 22.5528 22 16C22 9.44723 20.5228 3.8145 18.408 1.34066C19.4386 2.07772 20.3975 3.28569 21.2096 4.9099C22.6158 7.72227 23.5 11.6425 23.5 16C23.5 20.3575 22.6158 24.2777 21.2096 27.0901ZM12.5359 30.4263C11.3518 29.6638 10.2698 28.5157 9.35293 27.0487C7.60034 24.2446 6.5 20.3396 6.5 16C6.5 11.6604 7.60034 7.75543 9.35293 4.95129C10.2698 3.4843 11.3518 2.33622 12.5359 1.5737C9.85227 4.15601 8 9.64538 8 16C8 22.3546 9.85228 27.844 12.5359 30.4263ZM19.4641 30.4263C20.6482 29.6638 21.7302 28.5157 22.6471 27.0487C24.3997 24.2446 25.5 20.3396 25.5 16C25.5 11.6604 24.3997 7.75543 22.6471 4.95129C21.7302 3.4843 20.6482 2.33622 19.4641 1.57369C22.1477 4.15601 24 9.64538 24 16C24 22.3546 22.1477 27.844 19.4641 30.4263ZM7.91472 27.0137C8.91576 28.3484 10.0901 29.4299 11.3831 30.1963C8.18407 27.5275 6 22.1719 6 16C6 9.82814 8.18407 4.47248 11.3831 1.80367C10.0901 2.57012 8.91576 3.65157 7.91472 4.98629C5.81406 7.78716 4.5 11.6794 4.5 16C4.5 20.3206 5.81406 24.2128 7.91472 27.0137ZM24.0853 27.0137C23.0842 28.3484 21.9099 29.4299 20.6169 30.1963C23.8159 27.5275 26 22.1719 26 16C26 9.82814 23.8159 4.47247 20.6169 1.80366C21.9099 2.57012 23.0842 3.65157 24.0853 4.98629C26.1859 7.78716 27.5 11.6794 27.5 16C27.5 20.3206 26.1859 24.2128 24.0853 27.0137ZM10.1308 29.9589C5.63382 27.461 2.5 22.1798 2.5 16C2.5 9.82023 5.63382 4.53903 10.1308 2.04111C6.47197 4.78191 4 10.0061 4 16C4 21.9939 6.47198 27.2181 10.1308 29.9589ZM21.8692 29.9589C26.3662 27.461 29.5 22.1798 29.5 16C29.5 9.82023 26.3662 4.53903 21.8692 2.04111C25.528 4.78191 28 10.0061 28 16C28 21.9939 25.528 27.2181 21.8692 29.9589ZM0.5 16C0.5 21.9741 3.87982 27.1589 8.83167 29.7464C4.74007 26.9536 2 21.8425 2 16C2 10.1575 4.74006 5.04641 8.83167 2.2536C3.87982 4.84113 0.5 10.0259 0.5 16ZM31.5 16C31.5 21.9741 28.1202 27.1589 23.1683 29.7464C27.2599 26.9536 30 21.8425 30 16C30 10.1575 27.2599 5.04641 23.1683 2.2536C28.1202 4.84113 31.5 10.0259 31.5 16ZM16.9181 27.2517C17.2767 24.3826 17.5 20.4043 17.5 16C17.5 11.5957 17.2767 7.61743 16.9181 4.74831C16.7383 3.31024 16.5268 2.17002 16.299 1.39907C16.2826 1.34349 16.2662 1.29043 16.25 1.23984V30.7602C16.2662 30.7096 16.2826 30.6565 16.299 30.6009C16.5268 29.83 16.7383 28.6898 16.9181 27.2517ZM15.75 1.23984V30.7602C15.7338 30.7096 15.7174 30.6565 15.701 30.6009C15.4732 29.83 15.2617 28.6898 15.0819 27.2517C14.7233 24.3826 14.5 20.4043 14.5 16C14.5 11.5957 14.7233 7.61743 15.0819 4.74831C15.2617 3.31024 15.4732 2.17002 15.701 1.39907C15.7174 1.34349 15.7338 1.29043 15.75 1.23984Z"
                fill="#4F46E5"
              />
              <defs>
                <clipPath id="bgblur_0_265_2159_clip_path">
                  <path
                    fillRule="evenodd"
                    clipRule="evenodd"
                    d="M32 16C32 7.16344 24.8366 0 16 0C7.16344 0 0 7.16344 0 16C0 24.8366 7.16344 32 16 32C24.8366 32 32 24.8366 32 16ZM14 16C14 23.0216 14.5654 28.9869 15.3518 31.141C15.2033 30.987 15.0428 30.7748 14.8735 30.4882C14.43 29.7379 14.0133 28.619 13.6566 27.1924C12.9453 24.3471 12.5 20.3897 12.5 16C12.5 11.6103 12.9453 7.65294 13.6566 4.80756C14.0133 3.38102 14.43 2.26206 14.8735 1.51177C15.0428 1.22523 15.2033 1.01296 15.3518 0.858971C14.5654 3.01313 14 8.97835 14 16Z"
                  />
                </clipPath>
              </defs>
            </svg>
            <span className="font-['Fragment_Mono'] text-xl font-medium text-[#4F46E5]">
              OpenForge
            </span>
          </div>

          {/* Desktop Navigation */}
          <div className="hidden lg:block flex-grow">
            <NavLinks />
          </div>
        </div>

        {/* Auth Buttons */}
        <div className="hidden lg:flex items-center gap-3">
          <CustomButton
            onClick={() => router.push("/sign-in")}
            variant="secondary"
          >
            Sign in
          </CustomButton>
          <CustomButton onClick={() => {
            trackEvent("ctaClick", {
              _value: 0
            })
            router.push("/sign-up")
          }}>
            Get Early Access
          </CustomButton>
        </div>

        {/* Mobile Menu Button */}
        <button
          className="lg:hidden"
          onClick={() => setIsMenuOpen(!isMenuOpen)}
        >
          {isMenuOpen ? <X size={24} /> : <Menu size={24} />}
        </button>
      </div>

      {/* Mobile Menu */}
      {isMenuOpen && (
        <div className="lg:hidden bg-[#EEF2FF]/80 backdrop-blur-md px-4 py-6 shadow-lg">
          <NavLinks mobile />
          <div className="mt-6 flex flex-col gap-3">
            <CustomButton
              variant="secondary"
              className="w-full"
              onClick={() => router.push("/sign-in")}
            >
              Sign in
            </CustomButton>
            <CustomButton
              className="w-full"
              onClick={() => {
                trackEvent("ctaClick", {
                  _value: 0
                })
                return router.push("/sign-up")
              }}
            >
              Get Early Access
            </CustomButton>
          </div>
        </div>
      )}
    </nav>
  );
}
